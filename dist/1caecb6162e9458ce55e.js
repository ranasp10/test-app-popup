!function(){"use strict";var e,t;function i(e){$("#error-display").hide(),$("#not-configured").hide(),$("#gist-list-container").show(),getUserGists(e,(function(e,t){t||($("#gist-list").empty(),buildGistList($("#gist-list"),e,n))}))}function n(){$("#insert-button").removeAttr("disabled"),$(".ms-ListItem").removeClass("is-selected").removeAttr("checked"),$(this).children(".ms-ListItem").addClass("is-selected").attr("checked","checked")}function s(e){$("#not-configured").hide(),$("#gist-list-container").hide(),$("#error-display").text(e),$("#error-display").show()}function o(n){e=JSON.parse(n.message),setConfig(e,(function(n){t.close(),t=null,i(e.gitHubUserName)}))}function c(e){t=null}Office.initialize=function(n){jQuery(document).ready((function(){(e=getConfig())&&e.gitHubUserName?i(e.gitHubUserName):$("#not-configured").show(),$("#insert-button").on("click",(function(){var e=$(".ms-ListItem.is-selected").val();getGist(e,(function(e,t){e?buildBodyContent(e,(function(e,t){e?Office.context.mailbox.item.body.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Html},(function(e){e.status===Office.AsyncResultStatus.Failed&&s("Could not insert gist: "+e.error.message)})):s("Could not create insertable content: "+t)})):s("Could not retrieve gist: "+t)}))})),$("#settings-icon").on("click",(function(){var i=new URI("../src/settings/dialog.html").absoluteTo(window.location).toString();console.log("urll",i),e&&(i=i+"?gitHubUserName="+e.gitHubUserName+"&defaultGistId="+e.defaultGistId),Office.context.ui.displayDialogAsync(i,{width:50,height:50,displayInIframe:!0},(function(e){(t=e.value).addEventHandler(Microsoft.Office.WebExtension.EventType.DialogMessageReceived,o),t.addEventHandler(Microsoft.Office.WebExtension.EventType.DialogEventReceived,c)}))}))}))}}();