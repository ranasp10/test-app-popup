!function(){var e,t,i;function n(e){Office.context.mailbox.item.notificationMessages.replaceAsync("github-error",{type:"errorMessage",message:e},(function(e){}))}function o(n){e=JSON.parse(n.message),setConfig(e,(function(e){i.close(),i=null,t.completed(),t=null}))}function c(e){i=null,t.completed(),t=null}Office.initialize=function(e){},Office.actions.associate("insertDefaultGist",(function(f){if((e=getConfig())&&e.defaultGistId)try{getGist(e.defaultGistId,(function(e,t){e?buildBodyContent(e,(function(e,t){e?Office.context.mailbox.item.body.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Html},(function(e){f.completed()})):(n(t),f.completed())})):(n(t),f.completed())}))}catch(e){n(e),f.completed()}else{t=f;var l=new URI("../src/settings/dialog.html?warn=1").absoluteTo(window.location).toString();Office.context.ui.displayDialogAsync(l,{width:20,height:40,displayInIframe:!0},(function(e){(i=e.value).addEventHandler(Microsoft.Office.WebExtension.EventType.DialogMessageReceived,o),i.addEventHandler(Microsoft.Office.WebExtension.EventType.DialogEventReceived,c)}))}}))}();
//# sourceMappingURL=commands.js.map